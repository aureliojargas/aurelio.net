<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<meta name="author" content="Aurelio Jargas">
<META NAME="generator" CONTENT="http://txt2tags.org">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="../../include/yui-2.7.0.css">
<LINK REL="stylesheet" TYPE="text/css" HREF="../../include/10anos/base.css">
<LINK REL="stylesheet" TYPE="text/css" HREF="../../include/10anos/livro.css">
<link rel="shortcut icon" href="/favicon.ico">
<TITLE>Sed HOWTO — Parte 5/11 :: aurelio.net</TITLE>
</HEAD>
<BODY class="sedhowto">

<DIV ID="header">
<H1>Sed HOWTO — Parte 5/11</H1>
<H2>Conceitos básicos</H2>
<H3><a href="http://aurelio.net">Aurelio Marinho Jargas</a></H3>
</DIV>

<DIV ID="main">
<P>
<div class="prevnextnav"><A HREF="sed-HOWTO-4.html">« anterior</A> | <A HREF="index.html">índice</A> | <A HREF="sed-HOWTO-6.html">próximo »</A></div>
</P>
<P>
Aqui vão conhecimentos que você <B>precisa</B> assimilar para fazer um bom uso do
<I>Sed</I>.
</P>
<DIV CLASS="toc">

    <UL>
    <LI><A HREF="#toc1">5.1. Suprimindo a saída padrão</A>
      <UL>
      <LI><A HREF="#toc2">5.1.1. Saída normal</A>
      <LI><A HREF="#toc3">5.1.2. Saída suprimida</A>
      </UL>
    <LI><A HREF="#toc4">5.2. O endereço</A>
      <UL>
      <LI><A HREF="#toc5">5.2.1. Endereço simples</A>
      <LI><A HREF="#toc6">5.2.2. Intervalo</A>
      <LI><A HREF="#toc7">5.2.3. Outros</A>
      </UL>
    <LI><A HREF="#toc8">5.3. Interrompendo o processamento</A>
    <LI><A HREF="#toc9">5.4. Invertendo a lógica</A>
    <LI><A HREF="#toc10">5.5. Aplicando vários comandos de uma vez</A>
      <UL>
      <LI><A HREF="#toc11">5.5.1. Comandos normais</A>
      <LI><A HREF="#toc12">5.5.2. Comandos com parâmetros</A>
      <LI><A HREF="#toc13">5.5.3. Terceira via</A>
      </UL>
    </UL>

</DIV>

<H2 ID="toc1">0.1. Suprimindo a saída padrão</H2>

<H3 ID="toc2">0.1.1. Saída normal</H3>

<P>
Normalmente o <I>Sed</I> sempre imprime na <B>saída padrão</B> todas as linhas do
arquivo, modificadas ou não.
</P>
<P>
Veja o primeiro exemplo citado:
</P>

<PRE>
prompt$ sed 'p' texto.txt
</PRE>

<P>
O comando <B><CODE>p</CODE></B> imprime a linha na saída padrão. Este exemplo <B>duplica</B> todas
as linhas do arquivo pois, além da impressão normal de cada linha, ainda é
aplicado o comando <B><CODE>p</CODE></B> em cada uma, que diz "imprima esta linha", fazendo
com que ela apareça duas vezes.
</P>

<H3 ID="toc3">0.1.2. Saída suprimida</H3>

<P>
Temos como modificar este comportamento com a opção <B><CODE>-n</CODE></B>, que significa
"não imprima na saída, a não ser quando especificado com o comando <B><CODE>p</CODE></B> ou o
<B><CODE>l</CODE></B>".
</P>
<P>
Assim sendo, colocando o <B><CODE>-n</CODE></B>, eliminamos o comportamento padrão de
"imprimir sempre na saída":
</P>

<PRE>
prompt$ sed -n 'p' texto.txt
</PRE>

<P>
Que resulta no conteúdo do arquivo, pois cada linha é impressa apenas uma
vez, devido ao comando <B><CODE>p</CODE></B>. Assim fica fácil entender como funciona o
exemplo já citado que imprime apenas a <B>linha 5</B> de um arquivo:
</P>

<PRE>
prompt$ sed -n 5p texto.txt
</PRE>

<P>
Ok, a explicação daquele <B>5</B> ali perdido vem logo a seguir no tópico
O endereço :)
</P>

<H2 ID="toc4">0.2. O endereço</H2>

<P>
O endereço serve para você dizer ao <I>Sed</I> para aplicar um determinado
comando <B>apenas</B> nas linhas informadas. Este endereço pode ser descrito
direto como o <B>número</B> da linha, ou por <B>parte</B> de seu conteúdo (entre
<CODE>/barras/</CODE>).
</P>
<P>
Caso o endereço não seja informado, o comando <I>Sed</I> será aplicado para
<B>todas</B> as linhas.
</P>

<H3 ID="toc5">0.2.1. Endereço simples</H3>

<P>
Por exemplo, referenciando a linha pelo seu número, como já foi visto
anteriormente:
</P>

<PRE>
prompt$ sed '5d' texto.txt
</PRE>

<P>
Mas também poderia ser uma linha que tivesse uma palavra qualquer:
</P>

<PRE>
prompt$ sed '/estorvo/d' texto.txt
</PRE>

<P>
O comando <B><CODE>d</CODE></B> apaga linhas segundo o endereço, então este comando
apagará todas as linhas que tiverem a palavra <CODE>estorvo</CODE>. Este exemplo tem o
funcionamento idêntico ao comando:
</P>

<PRE>
prompt$ grep -v estorvo texto.txt
</PRE>

<H3 ID="toc6">0.2.2. Intervalo</H3>

<P>
Como endereço, ainda se pode especificar um <B>intervalo</B>, como da linha
5 até a linha 10, ou da linha 5 até a linha que tiver a palavra <CODE>estorvo</CODE>:
</P>

<PRE>
prompt$ sed '5,10d' texto.txt
prompt$ sed '5,/estorvo/d' texto.txt
</PRE>

<P>
No endereço, temos um caractere especial, o <B><CODE>$</CODE></B> que referencia à
<B>última</B> linha do texto. Assim sendo, para apagar da <B>linha 10</B> até o
<B>final</B> do texto, o comando é:
</P>

<PRE>
prompt$ sed '10,$d' texto.txt
</PRE>

<H3 ID="toc7">0.2.3. Outros</H3>

<P>
No <I>Sed</I> da GNU, a partir da versão <B>3.02a</B>(*), foi adicionada uma maneira
nova de especificar um endereço:
</P>

<PRE>
prompt$ sed '/estorvo/,+3d' texto.txt
</PRE>

<P>
Que referencia a linha que contém a palavra <CODE>estorvo</CODE> e mais as <B>3</B> linhas
seguintes.
</P>
<P>
E pra finalizar, como já dito anteriormente, quando o comando <B>não</B> tem
endereço, é aplicado para todas as linhas:
</P>

<PRE>
prompt$ sed 'd' texto.txt
</PRE>

<P>
(*) veja o tópico <A HREF="sed-HOWTO-10.html">Nota sobre os adicionais GNU</A>
</P>

<H2 ID="toc8">0.3. Interrompendo o processamento</H2>

<P>
A qualquer hora você pode <B>abortar</B> o comando <I>Sed</I> com o comando <B><CODE>q</CODE></B>.
</P>
<P>
Isso é útil no nosso exemplo anterior de emular o comando <I>head</I>,
imprimindo apenas as 10 primeiras linhas do arquivo:
</P>

<PRE>
sed '10q'         ao chegar na linha 10, pare.
</PRE>

<P>
Ou ainda, para obter apenas os cabeçalhos de uma mensagem de e-mail, que
são separados do corpo da mensagem por uma linha em branco:
</P>

<PRE>
sed '/^$/q'       pare na primeira linha em branco que achar
</PRE>

<H2 ID="toc9">0.4. Invertendo a lógica</H2>

<P>
No <I>Sed</I> temos o modificador <B><CODE>!</CODE></B> que <B>inverte</B> a lógica do comando, ou seja
<CODE>!comando</CODE> significa "não execute o comando". É meio estranho a primeira
vista, mas você tem que começar a pensar como o <I>Sed</I>, e tudo se esclarece
:)
</P>
<P>
Temos o comando <I>head</I> que imprime as 10 primeiras linhas de um arquivo.
Com as dicas já vistas, podemos fazer esta tarefa com o <I>Sed</I> assim:
</P>

<PRE>
sed -n '1,10p'    imprima apenas da linha 1 até a 10
sed '11,$d'       apague da linha 11 até o final
</PRE>

<P>
Ou ainda, podemos inverter a lógica e fazer:
</P>

<PRE>
sed '1,10!d'      NÃO apague da linha 1 até a 10 (ou seja, apague as outras)
sed -n '11,$!p'   NÃO imprima da linha 11 até o final (ou seja, imprima as outras)
</PRE>

<P>
A dica é sempre complementar a leitura mental com o inverso (entre
parênteses nos exemplos), ou seja, se o <I>Sed</I> NÃO vai aplicar um comando em
determinadas linhas, isso quer dizer implicitamente que este comando
<B>será aplicado</B> em todas as outras linhas. É estranho, mas acostuma :)
</P>

<H2 ID="toc10">0.5. Aplicando vários comandos de uma vez</H2>

<H3 ID="toc11">0.5.1. Comandos normais</H3>

<P>
É possível aplicar vários comandos <I>Sed</I>, em <B>seqüência</B>. Basta
separá-los por ponto-e-vírgula.
</P>

<PRE>
prompt$ sed '5d;10d;/estorvo/d' texto.txt
</PRE>

<P>
Este comando apaga as linhas 5, 10 e as que têm <CODE>estorvo</CODE> do arquivo
<I>texto.txt</I>.
</P>

<H3 ID="toc12">0.5.2. Comandos com parâmetros</H3>

<P>
Os comandos que recebem parâmetros (<B><CODE>r</CODE></B>, <B><CODE>w</CODE></B>, <B><CODE>i</CODE></B>, <B><CODE>a</CODE></B>, <B><CODE>c</CODE></B>), não aceitam
o ponto-e-vírgula como separador, pois este pode ser parte integrante do
parâmetro esperado.
</P>
<P>
Estes comandos devem ser separados dos restantes, sendo passados como
comandos isolados, pela opção de linha de comando <B><CODE>-e</CODE></B>:
</P>

<PRE>
prompt$ sed -e '1i começo de tudo' -e '5d' texto.txt
</PRE>

<P>
Este comando insere a frase <CODE>começo de tudo</CODE> antes da primeira linha e
apaga a quinta linha do arquivo <I>texto.txt</I>.
</P>

<H3 ID="toc13">0.5.3. Terceira via</H3>

<P>
Outra maneira de especificar vários comandos (e a mais consistente e
garantida) é colocá-los num arquivo, um por linha. Veja o tópico
<A HREF="sed-HOWTO-8.html#toc2">Colocando comandos Sed num arquivo</A>.
</P>
<P>
<div class="prevnextnav"><A HREF="sed-HOWTO-4.html">« anterior</A> | <A HREF="index.html">índice</A> | <A HREF="sed-HOWTO-6.html">próximo »</A></div>
</P>
<P>
<a href="http://aurelio.net/sed/" class="linkblock"><IMG ALIGN="middle" SRC="../../img/icon/128/sed.png" BORDER="0" ALT=""> Aprenda mais sobre Sed</a>
</P>
</div> <!-- close #main -->
<div id="nav">

<table>
<tr>
	<th colspan="5" align="center"><a href="http://aurelio.net">AURELIO.NET</a></th>
</tr>
<tr>	
	<th class="search" colspan="5">
 
<form action="http://aurelio.net/achei.html" id="cse-search-box">
  <div>
    <input type="hidden" name="cx" value="partner-pub-0009608813278754:22aq1wdkwbb" />
    <input type="hidden" name="cof" value="FORID:10" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="31" />
    <input type="submit" name="sa" value="Pesquisar" />
  </div>
</form>

<script type="text/javascript" src="http://www.google.com.br/coop/cse/brand?form=cse-search-box&amp;lang=pt"></script>
	</th>
</tr>
<tr><td>
<P>
<B>Nerdices</B>
</P>

<UL>
<LI><A HREF="/misc/adventure-mapa.txt">adventure</A>
<LI><A HREF="/doc/as4pp.html">applescript</A>
<LI><A HREF="http://aurelio.net/shell/canivete/">canivete</A>
<LI><A HREF="/doc/CAPSLOCK.txt">capslock</A>
<LI><A HREF="http://codare.net">codare</A>
<LI><A HREF="/doc/coluna/">coluna</A>
<LI><A HREF="http://aurelio.net/curso/">curso</A>
<LI><A HREF="http://aurelio.net/cygwin/">cygwin</A>
<LI><A HREF="http://aurelio.net/shell/dialog/">dialog</A>
<LI><A HREF="/doc/dort.html">dort</A>
<LI><A HREF="/er/">er</A>
<LI><A HREF="/log/">log</A>
<LI><A HREF="/mac/">mac</A>
<LI><A HREF="/curso/">palestra</A>
<LI><A HREF="/misc/eu_odeio_perl.txt">perl</A>
<LI><A HREF="http://aurelio.net/mac/dev/tutorial-pyobjc/">pyobjc</A>
<LI><A HREF="/bin/python/">python</A>
<LI><A HREF="/sed/">sed</A>
<LI><A HREF="http://aurelio.net/shell/">shell</A>
<LI><A HREF="/bin/sql/">sql</A>
<LI><A HREF="http://aurelio.net/vim/">vim</A>
<LI><A HREF="/doc/nerd.html">mais...</A>
<LI><A HREF="/en/">more...</A>
</UL>

</td><td>
<P>
<B>Programas</B>
</P>

<UL>
<LI><A HREF="http://aurelio.net/projects/adiumbook/">adiumbook</A>
<LI><A HREF="http://aurelio.net/projects/css-sandbox/">css-sandbox</A>
<LI><A HREF="http://www.coisinha.com.br/embriagueitor/">embriagueitor</A>
<LI><A HREF="http://aurelio.net/projects/emomemory/">emomemory</A>
<LI><A HREF="http://www.coisinha.com.br/engripeitor/">engripeitor</A>
<LI><A HREF="/bin/lelolab/">lelolab</A>
<LI><A HREF="http://www.coisinha.com.br/miguxeitor/">miguxeitor</A>
<LI><A HREF="http://aurelio.net/moneylog/">moneylog</A>
<LI><A HREF="http://aurelio.net/rac/">rac</A>
<LI><A HREF="http://aurelio.net/projects/sedsed/">sedsed</A>
<LI><A HREF="http://aurelio.net/projects/sedsokoban/">sedsokoban</A>
<LI><A HREF="http://aurelio.net/projects/sedarkanoid/">sedarkanoid</A>
<LI><A HREF="http://aurelio.net/projects/txt2regex/">txt2regex</A>
<LI><A HREF="http://txt2tags.org/pt/">txt2tags</A>
<LI><A HREF="http://funcoeszz.net">zz</A>
<LI><A HREF="/bin/">mais...</A>
<LI><A HREF="/soft/">more...</A>
</UL>

</td><td>
<P>
<B>Livros</B>
</P>

<UL>
<LI><A HREF="http://aurelio.net/regex/guia/">guia-er</A>
<LI><A HREF="http://www.piazinho.com.br">regex</A>
<LI><A HREF="http://aurelio.net/sed/livro/">sed</A>
<LI><A HREF="http://www.shellscript.com.br">shell</A>
</UL>

</td><td>
<P>
<B>Eu</B>
</P>

<UL>
<LI><A HREF="http://aurelio.net/blog">blog</A>
<LI><A HREF="/cv">cv</A>
<LI><A HREF="/img/emeio.png">e-mail</A>
<LI><A HREF="/faq">faq</A>
<LI><A HREF="/mim.html">raio-x</A>
<LI><A HREF="http://twitter.com/oreio">twitter</A>
</UL>

</td><td>
<P>
<B>Diversos</B>
</P>

<UL>
<LI><A HREF="/1000000000000.html">10<sup>12</sup></A>
<LI><A HREF="/adsense/">adsense</A>
<LI><A HREF="/atacama">atacama</A>
<LI><A HREF="http://aurelio.net/baterna/">baterna</A>
<LI><A HREF="http://aurelio.net/carve/">carve</A>
<LI><A HREF="http://www.coisinha.com.br">coisinha</A>
<LI><A HREF="/correria/">correria</A>
<LI><A HREF="/dumbs/">dumbs</A>
<LI><A HREF="/foto/">foto</A>
<LI><A HREF="http://aurelio.net/fvm/">fvm</A>
<LI><A HREF="/musica/">musica</A>
<LI><A HREF="http://aurelio.net/pogo/">pogo</A>
<LI><A HREF="/doc/ramones.txt">ramones</A>
<LI><A HREF="/sobre.html">sobre</A>
<LI><A HREF="http://aurelio.net/surf/">surf</A>
<LI><A HREF="/misc/toyota/">toyota</A>
<LI><A HREF="http://umportugues.com">umportugues</A>
<LI><A HREF="/valeta/">valeta</A>
<LI><A HREF="http://aurelio.net/viagem/">viagem</A>
<LI><A HREF="/doc/videogame.html">videogame</A>
</UL>

</td><tr>
</table>
</div> <!-- #nav -->

<div id="footer">
<P>
<A HREF="/sobre/">AURELIO.NET</A> é o site pessoal de Aur<A HREF="http://aurelio.net/blog/2011/05/26/aos-33-descobri-que-meu-nome-nao-tem-acento/">e</A>lio Marinho Jargas.<br>
Mais de <A HREF="http://aurelio.net/blog/2009/06/27/10-anos-de-saite/">10 anos no ar</A> (desde 1999), feito com <A HREF="http://txt2tags.org/pt/">txt2tags</A>
e <A HREF="http://www.dreamhost.com/r.cgi?251258">DreamHost</A>.
<br>
Contato:
<A HREF="/img/emeio.png">e-mail</A>, <A HREF="http://twitter.com/oreio">twitter</A>.
</P>
</div> <!-- #footer -->
<a class="cabecao" href="/" title="AURELIO.NET — Organizações Verde Inc.™" alt="AURELIO.NET — Organizações Verde Inc.™"><img src="/include/10anos/aureliolga.jpg"></a>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-280222-1']);
  _gaq.push(['_trackPageview']);
  _gaq.push(['_trackPageLoadTime']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</DIV>

<!-- html code generated by txt2tags 2.6.896 (http://txt2tags.org) -->
<!-- cmdline: txt2tags sed/sed-HOWTO/sed-HOWTO-5.t2t -->
</BODY></HTML>
