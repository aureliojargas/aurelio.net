---
date: 2003-11-09
title: Seleção VI-sual
---

<!--09-Nov-2003 16:15 2h-->
<!--Copiado do original em /a/grana/linuxmag/sel_visual/vi-selecao_visual.t2t-->

<blockquote>Seja um guru do Vim (VI) na arte de selecionar texto, usando caracteres, linhas e até colunas inteiras, para depois recortar, copiar ou alterar o texto.</blockquote>

<p>O nome do VI vem da palavra "Visual". Editor de textos revolucionário em sua época, sua primeira versão já trazia uma impressionante característica: podia mostrar na tela o texto que estava sendo editado!</p>

<p>Já pensou ter que editar um texto com o monitor desligado, só digitando os comandos e torcendo para que tudo fique certo? Pois assim eram os editores antes do VI, como o seu antecessor <code>ed</code>. Nada de cursor, setinhas, letras aparecendo e sumindo na tela. A edição era feita às escuras. E você achando que o VI é que é complicado, hein?</p>

<p>Pois bem, neste artigo vamos conhecer o "modo visual" do VI. O nome pode causar confusão, mas esse modo nada tem a ver com o fato do VI ser um editor visual. O modo visual é o nome que se dá quando fazemos uma seleção de texto, igual aos editores gráficos quando selecionamos um texto com o mouse.</p>

<p>Como o VI não depende de mouse para ser operado, há meios de selecionar um texto somente com o teclado. A tecla chave é o V (de Visual, claro!).</p>

<p><strong>Variantes do modo visual</strong></p>

<table class="tableborder">
  <tr>
    <th>Comando</th>
    <th>Nome</th>
    <th>Ação</th>
  </tr>
  <tr>
    <td class="center">v</td>
    <td class="center">-- VISUAL --</td>
    <td>Seleciona caracteres</td>
  </tr>
  <tr>
    <td class="center">V</td>
    <td class="center">-- VISUAL LINE --</td>
    <td>Seleciona linhas</td>
  </tr>
  <tr>
    <td class="center">Ctrl+V</td>
    <td class="center">-- VISUAL BLOCK --</td>
    <td>Seleciona blocos (seleção vertical)</td>
  </tr>
</table>

<p>Diferente da seleção de texto em outros editores, que só serve para apagar o texto selecionado, copiá-lo ou trocá-lo por outro texto, a seleção visual do VI é um aliado poderoso para se fazer edições complicadas com pouco esforço.</p>

<p>Abra um texto qualquer no VI e brinque de selecionar trechos para se familiarizar com os três modos de seleção. Primeiro posicione o cursor no meio de uma linha, tecle <code>v</code> e mova o cursor com as setas do teclado para ver a seleção se formando: o texto selecionado ficará em destaque. Tecle <code>v</code> novamente (ou <code>Esc</code>) para cancelar a seleção.</p>

<p>Agora volte ao mesmo meio da linha inicial e tecle <code>V</code> (maiúsculo). Surpresa! A linha inteira foi selecionada. Usando as setas para cima e para baixo podemos incluir mais linhas inteiras na seleção. Tecle <code>V</code> ou <code>Esc</code>, para cancelar a seleção.</p>

<p>Volte novamente ao meio da linha e agora tecle <code>Ctrl+V</code> para fazer a seleção de blocos. Mova o cursor para baixo e para a direita e veja o retângulo se formando. Antes de cancelar esta seleção, veja que é possível mudar o modo de seleção sem perder o posicionamento atual! Ainda com o bloco selecionado, tecle <code>v</code> para trocar para seleção de caracteres, depois tecle <code>V</code> para selecionar as linhas.</p>

<p>Tecle <code>Esc</code> para cancelar a seleção. Um comando bacana é o <code>gv</code> (Go Visual), que restaura a última seleção feita. Agora, com algumas linhas selecionadas, vamos fazer algo com elas. Veja na tabela 2 alguns dos comandos disponíveis.</p>

<p><strong>Alguns comandos do VI</strong></p>

<table class="tableborder">
  <tr>
    <th>Comando</th>
    <th>Ação no texto selecionado</th>
  </tr>
  <tr>
    <td class="center">d</td>
    <td>Apaga</td>
  </tr>
  <tr>
    <td class="center">y</td>
    <td>Copia</td>
  </tr>
  <tr>
    <td class="center">p</td>
    <td>Cola</td>
  </tr>
  <tr>
    <td class="center">c</td>
    <td>Troca por outro texto</td>
  </tr>
  <tr>
    <td class="center">r</td>
    <td>Troca cada letra por um caractere</td>
  </tr>
  <tr>
    <td class="center">J</td>
    <td>Junta todas as linhas em uma só</td>
  </tr>
  <tr>
    <td class="center">U</td>
    <td>Converte para maiúsculas</td>
  </tr>
  <tr>
    <td class="center">u</td>
    <td>Converte para minúsculas</td>
  </tr>
  <tr>
    <td class="center">~</td>
    <td>Inverte maiúsculas e minúsculas</td>
  </tr>
  <tr>
    <td class="center">gq</td>
    <td>Reformata as linhas para a largura desejada</td>
  </tr>
  <tr>
    <td class="center">!</td>
    <td>Manda as linhas para um comando externo (!sort)</td>
  </tr>
  <tr>
    <td class="center">:</td>
    <td>Aplica um comando 'ex' nas linhas (:s/isso/aquilo/)</td>
  </tr>
</table>

<p>Brinque bastante com cada um desses comandos para se acostumar e veja que seu uso do VI ficará muito mais ágil. Por exemplo, quer apagar todo um conjunto de linhas? Vá até a primeira, aperte <code>V</code> e desça com o cursor até a última linha, então aperte <code>d</code> e pronto: linhas apagadas.</p>

<p>O comando <code>r</code> é interessante no modo de seleção: ele troca todos os caracteres do trecho selecionado por um caractere à sua escolha, bom para "esconder" uma parte do texto.</p>

<p>Muito úteis também são o <code>u</code> e o <code>U</code>, para deixar o texto todo em minúsculas ou maiúsculas, não importando como era o trecho original. Experimente também o <code>gq</code>, que reformata as linhas, juntando-as e dividindo novamente para que a largura máxima (<code>:set textwidth</code>) seja respeitada.</p>

<p>E por último, o poder dos comandos "<code>!</code>" e "<code>:</code>" aplicados à seleção. Para ordenar alfabeticamente apenas algumas linhas do texto, e não ele todo, selecione as linhas desejadas com o <code>V</code> e digite <code>!sort</code> seguido de ENTER. Para substituir palavras apenas na seleção, novamente selecione o texto desejado e tecle <code>:s/isso/aquilo/</code> e tecle ENTER.</p>

<p>Ao usar esses comandos, surge na última linha da tela o texto <code>:'&lt;,'&gt;</code>. Não se preocupe, ele está ali para indicar que o comando digitado em seguida será aplicado apenas ao trecho selecionado.</p>

<p>Note que após aplicado o comando, o VI volta para o modo anterior, abandonando o modo visual. Resumindo, este modo é composto por três operações:</p>

<ol>
  <li>Iniciar o modo visual com <code>v</code>, <code>V</code> ou <code>Ctrl+V</code></li>
  <li>Mover o cursor para selecionar o texto</li>
  <li>Aplicar um comando à seleção</li>
</ol>

<p>Durante o passo 2 de demarcar a seleção, se você apertar a tecla <code>o</code> (letra o de ontem, minúscula), o cursor alterna entre o início e o fim do trecho marcado. Dessa maneira é possível aumentar o tamanho de uma seleção já iniciada.</p>

<p>Isso é tudo o que qualquer usuário normal precisa saber para usar e abusar da seleção visual e tornar a edição de textos no vi mais confortável. A partir daqui entraremos num mundo bizarro, onde coisas estranhas e surpreendentes acontecem. Continue lendo por sua conta e risco.</p>

<p>A seleção de blocos (<code>Ctrl+V</code>) reserva algumas surpresas. Para entender o que vai acontecer com os comandos a seguir, é imprescindível que você tenha o VI aberto com um texto qualquer e repita exatamente em sua máquina todos os procedimentos descritos.</p>

<p>Já precisou incluir no início de algumas linhas um texto padrão? É possível fazer isso com um <code>:s/^/TEXTO/</code>, mas com a seleção visual isso é muito mais divertido. Vá com o cursor até o início de uma linha qualquer, aperte <code>Ctrl+V</code> e desça 7 linhas com a seta. Tecle <code>I</code> (maiúsculo) e logo em seguida digite "MÁGICA". Agora pare, respire fundo, olhe atentamente para a tela e tecle <code>Esc</code>. Meio segundo se passa e PLIM!, letras pipocam na tela. Isso é mágica!</p>

<p>Este foi o comando <code>I</code>, que <strong>I</strong>nsere um texto antes da seleção. Para inserir depois, o comando é <code>A</code>, de <strong>A</strong>nexar. Este fica de exercício para você brincar sozinho. O comando que fecha a trinca é o <code>c</code> (minúsculo), de <strong>C</strong>hange, que troca o texto selecionado por outro.</p>

<p>O comando <code>c</code> é muito útil para editar tabelas. Selecione uma coluna vertical no meio da linha com o <code>Ctrl+V</code>, digamos cinco linhas e cinco colunas. Tecle <code>c</code>, depois digite <code>@@@@@</code>. Novamente respire fundo, tecle <code>Esc</code> e PLIM!, a mágica acontece!</p>

<p>A última dica da seleção em bloco é útil para quando o bloco precisar ir até o final de todas as linhas, mas estas têm tamanhos diversos. Nesse caso o bloco sairá incompleto se a última linha não a for a mais longa. Enquanto estiver movendo o cursor para marcar o bloco, aperte <code>$</code> para expandir o bloco até o final de todas as linhas selecionadas.</p>

<p>Ah! E antes tarde do que nunca, um aviso: este modo visual não faz parte do VI original, é uma característica presente no Vim, o Vi IMproved. Como ele é o "Vi" padrão da maioria das distros recentes, a seleção visual está disponível a praticamente todos os usuários.</p>

<blockquote>Artigo originalmente publicado na Linux Magazine edição 2, de outubro de 2004. <a href="/vim/selecao-vi-sual.pdf">Veja o PDF original</a></blockquote>
